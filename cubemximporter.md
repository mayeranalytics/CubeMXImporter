# Extensions to the original cubemximporter.py #

## Overview ##

This is an extension to the original cubemximporter tool by Carmine Noviello at [github.com/cnoviello](github.com/cnoviello). The main purpose of the tool is to merge the project file tree created by the [STM32CubeMX](http://www.st.com/web/catalog/tools/FM147/CL1794/SC961/SS1533/PF259242) tool into the project file tree
generated by the Eclipse ARM plugin. In the course of this many files with user code, such as `main.c`, will be overwritten. When experimenting with STM32CubeMX projects this can be quite annoying.

The extension therefore attempts to extract the user code before it is overwritten and then re-inserts it into the newly merged Eclipse project.

The code produced by STM32CubeMX has a feature that allows to do this, provided the user puts his source code into structures such as the following:

```
  /* USER CODE BEGIN section_name */
  // some code here...
  /* USER CODE END section_name */
```

The extension scans all files for sections like these, save the source code inside, and re-inserts it after the files were changed by cubemximporter. 

## Details ##
The normal function of `cubemximport.py` is sandwiched between two actions of the extension:

1. All the files in `eclipse_project_folder` having extensions `.c`, `.cpp`, `.cxx`, `.cc`, `.h`, `.hpp`, `.hxx`, `.hh` are scanned and the source code inside the user code sections is extracted.
2. Files are copied from the `cubemx_project_folder` to `eclipse_project_folder` in the usual way. Most of the files under `eclipse_project_folder` will be overwritten.
3. The extracted user code sections are reinserted in the appropriate places in the files under `eclipse_project_folder`.

## Usage ##
```
usage: cubemximporter.py [-h] [-v VERBOSE] [--dryrun] [--dump] [--insert]
                         [--no-backup]
                         eclipse_project_folder cubemx_project_folder

Import a STM32CubeMX generated project inside an existing Eclipse project
generated with the GNU ARM plugin

positional arguments:
  eclipse_project_folder
                        Path to the Eclipse project
  cubemx_project_folder
                        Path to the STM32CubeMX project

optional arguments:
  -h, --help            show this help message and exit
  -v VERBOSE, --verbose VERBOSE
                        Verbosity level: 1=Error (default), 2=Info, 3=Debug
  --dryrun              Don't perform any operations - for debug purposes
  --dump                Dump the user code sections
  --insert              Re-insert the user code sections into the Eclipse
                        project code.
  --no-backup           Do NOT make a backup before re-inserting the user
                        section code.
```


## Caveats ##
* <aside class="warning">Source code outside the BEGIN-END structures will not be saved!</aside>
* <aside class="warning">The backup feature may save you some trouble but it is not 100% failsafe. E.g. source files that don't have any user code sections will not be backed up.</aside>
* 

## Todo ##
* More test